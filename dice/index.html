<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vayl Dice</title>

  <!-- Fonts -->
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap">

  <!-- Dice Widget CSS -->
  <link rel="stylesheet" href="dice.css">
</head>

<body>

  <!-- PAGE LAYOUT -->
  <div id="layout">

    <!-- === SIDEBAR (CONFIG MODE ONLY) === -->
    <aside id="editor">
      <h2>
        <img src="https://vaylvn.github.io/spinner/assets/logo.png"
             alt="Logo"
             style="height:40px; width:40px; margin-right:6px;">
        Dice Roller
      </h2>

      <!-- DICE LIST -->
      <section>
        <h3>Dice</h3>
        <table id="diceTable">
          <thead>
            <tr>
              <th>Faces</th>
              <th>Color</th>
              <th>Number</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="diceRows"></tbody>
        </table>
        <button id="addDie">+ Add Die</button>
      </section>

      <!-- ANIMATION -->
      <section>
        <h3>Animation</h3>
        <label>
          Roll Duration
          <input type="range" id="rollDuration" min="1000" max="5000" step="100" value="2000">
          <span id="rollDurationVal">2000</span> ms
        </label>

        <br>

        <label>
          Stagger (per die)
          <input type="number" id="stagger" min="0" max="2000" value="150">
          ms
        </label>
      </section>

      <!-- BEHAVIOUR -->
      <section>
        <h3>Behaviour</h3>
        <label>
          Auto-Roll
          <input type="checkbox" id="autoRoll">
        </label>
      </section>

      <!-- IMPORT / EXPORT -->
      <section>
        <h3>Export / Import</h3>

        <label>Share URL</label>
        <input id="shareUrl" readonly>
        <button id="copyUrl">Copy</button>

        <br><br>

        <label>Load Config</label>
        <input id="urlImport" placeholder="Paste dice URL…">
        <button id="importUrl">Load</button>
      </section>

    </aside>

    <!-- === MAIN CANVAS === -->
    <main id="widgetPanel">
      <canvas id="diceCanvas" width="600" height="400"></canvas>
    </main>

  </div>

  <p id="version">v1.2</p>


  <!-- === MODE DETECTION === -->
  <script>
    const isLive = window.location.search.includes("data=");
    document.body.dataset.mode = isLive ? "live" : "config";

    if (isLive) {
      document.body.style.background = "transparent";
      document.documentElement.style.background = "transparent";
    }
  </script>

  <!-- === TWEEN (still needed for config animations) === -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>


  <!-- === CONFIG OR WIDGET SCRIPT === -->
  <script>
    if (document.body.dataset.mode === "config") {
      const script = document.createElement("script");
      script.src = "dice-config.js";
      document.body.appendChild(script);

    } else {

      // LIVE MODE — clean module import
      const liveScript = document.createElement("script");
      liveScript.type = "module";
      liveScript.textContent = `
        import { initDiceWidget } from "./dice-widget.js";
        const canvas = document.getElementById("diceCanvas");
        const widget = initDiceWidget(canvas);
        canvas.addEventListener("click", widget.rollDice);
      `;
      document.body.appendChild(liveScript);

    }
  </script>

</body>
</html>
